version: 2

sources:
  - name: pypi
    database: bigquery-public-data
    schema: pypi
    description: See documentation at https://packaging.python.org/en/latest/guides/analyzing-pypi-package-downloads/#public-dataset
    tables:
      - name: file_downloads
        tests:
          - dbt_utils.recency:
              datepart: day
              field: timestamp
              interval: 3
              config:
                where: timestamp > TIMESTAMP_SUB(CURRENT_TIMESTAMP, INTERVAL 4 DAY)