{{ config(materialized='table') }}
SELECT
    download_date,
    package,
    installer,
    was_vulnerable,
    SUM(download_count) download_sum,
    GROUPING(download_date) AS download_date_agg,
    GROUPING(package) AS package_agg,
    GROUPING(installer) AS installer_agg,
    GROUPING(was_vulnerable) AS was_vulnerable_agg
FROM {{ ref('vulnerable_downloads') }}
GROUP BY CUBE (download_date, package, installer, was_vulnerable)