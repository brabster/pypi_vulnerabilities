version: 2

models:
  - name: vulnerable_downloads_by_package
    description: Package downloads by installer breakdown for 2023-11-05 based on Safety DB @ 2023-10-01
    columns:
      - name: package
        description: Package identification string
        tests:
          - not_null
          - unique
          - dbt_utils.at_least_one

      - name: was_vulnerable
        description: True when the package version downloaded had a known vulnerability at time of download
        tests:
          - not_null
          - dbt_utils.at_least_one
          - accepted_values:
              values: [true, false]
              quote: false

      - name: downloads
        description: Number of downloads
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0

      - name: proportion_vulnerable_downloads
        description: Known vulnerable proportion of total downloads
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 1
      